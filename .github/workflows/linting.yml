name: Linting

# yamllint disable-line rule:truthy
on: [push, pull_request]

permissions:
  contents: read
jobs:
  prek:
    name: Run prek checks
    runs-on: ubuntu-latest
    needs: [info]
    if: |
      github.event.inputs.pylint-only != 'true'
      && github.event.inputs.mypy-only != 'true'
      && github.event.inputs.audit-licenses-only != 'true'
    steps:
      - uses: actions/checkout@v6
      - name: Register problem matchers
        run: |
          echo "::add-matcher::.github/workflows/matchers/yamllint.json"
          echo "::add-matcher::.github/workflows/matchers/check-json.json"
          echo "::add-matcher::.github/workflows/matchers/check-executables-have-shebangs.json"
          echo "::add-matcher::.github/workflows/matchers/codespell.json"
      - name: Run prek
        uses: j178/prek-action@v1.1.0 # v1.1.0
        env:
          RUFF_OUTPUT_FORMAT: github
